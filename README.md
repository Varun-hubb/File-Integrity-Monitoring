# File-Integrity-Monitoring
This project demonstrates the implementation of File Integrity Monitoring using Wazuh SIEM to detect unauthorized file changes in real time.  The system monitors critical directories and generates alerts for file creation, modification, and deletion.

## Objective
The objective of this project is to implement and demonstrate File Integrity Monitoring (FIM) using Wazuh SIEM to detect, log, and analyze unauthorized changes to critical files and system configurations on a Windows system, enabling improved security monitoring and incident response.

### System Architecture

![System Architecture](docs/architecture.drawio.png)

###  Component Explanation

The architecture of this File Integrity Monitoring system consists of the following main components:

#### 1. Wazuh Agent (Windows Endpoint)
- Installed on the monitored Windows machine.
- Continuously monitors files, directories, and registry entries using the Syscheck module.
- Detects file creation, modification, deletion, and registry changes.
- Sends collected events securely to the Wazuh Manager.

#### 2. Wazuh Manager (Ubuntu Server)
- Acts as the central processing unit of the SIEM system.
- Receives security events from agents.
- Analyzes logs using predefined rules and decoders.
- Generates alerts based on file integrity violations.

#### 3. Filebeat
- Collects alerts and logs generated by the Wazuh Manager.
- Forwards them to OpenSearch for indexing and storage.
- Ensures reliable and real-time log transmission.

#### 4. OpenSearch (Indexer)
- Stores and indexes security events and alerts.
- Enables fast searching and filtering of file integrity data.
- Supports visualization and analytics.

#### 5. Wazuh Dashboard
- Provides a web-based interface for monitoring.
- Displays File Integrity Monitoring alerts and statistics.
- Allows filtering, searching, and analysis of security events.

#### 6. Administrator / Analyst
- Accesses the dashboard to monitor system integrity.
- Investigates suspicious file or registry changes.
- Takes corrective actions if needed.

###  Data Flow Description

The data flow in the File Integrity Monitoring system follows a structured pipeline:

1. The Wazuh Agent continuously monitors configured files, folders, and registry paths on the Windows endpoint.

2. When a change occurs (create, modify, delete, or registry update), the Syscheck module detects the event in real time.

3. The detected event is packaged into a security log and sent securely to the Wazuh Manager.

4. The Wazuh Manager analyzes the incoming log using decoders and rules to determine its severity.

5. If the event matches a File Integrity Monitoring rule, an alert is generated.

6. Filebeat collects the generated alert from the Wazuh Manager.

7. Filebeat forwards the alert to OpenSearch over a secure connection.

8. OpenSearch indexes and stores the event for fast querying.

9. The Wazuh Dashboard retrieves indexed data from OpenSearch.

10. The Administrator views and analyzes the alerts through the dashboard interface.

## Technologies Used

- Wazuh SIEM (Manager, Agent, Dashboard)
- OpenSearch (Indexer)
- Filebeat (Log Forwarding)
- Ubuntu Linux (Wazuh Server)
- Windows 11 (Monitored Endpoint)
- VirtualBox (Virtualization Platform)
- Draw.io (Architecture Diagram Tool)
- Git & GitHub (Version Control)

### Installation and Setup

This section describes the complete setup process from installing Wazuh v4.12 to validating File Integrity Monitoring (FIM).

---

### Step 1: Install Wazuh Server (Ubuntu 22.04)
1. Log in to the Ubuntu virtual machine.
2. Update the system packages:

   ```bash
   sudo apt update && sudo apt upgrade -y
   ```
3. Download and execute the official installation script:

```bash
curl -sO https://packages.wazuh.com/4.14/wazuh-install.sh
sudo bash wazuh-install.sh -a
```
![Wazuh Install](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/Wazuh%20Installed.png)

4. Wait for the installation to complete.
5. Note down the generated admin credentials.

---

### Step 2: Verify Installation

```md
### Step 2: Verify Installation

```bash
sudo systemctl status wazuh-manager
sudo systemctl status wazuh-indexer
sudo systemctl status wazuh-dashboard
````

![Services](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-manager-status.png)

---

### Step 3. Access Wazuh Dashboard

## Accessing the Wazuh Dashboard

1. Open a web browser on the Ubuntu system.
2. Navigate to:

```md
   https://localhost
```
3. Accept the security warning.
4. Log in using the admin credentials.
5. Verify that the dashboard loads successfully.

![Wazuh-login-page](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-login-page.png)

![Dashboard](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-dashboard-1.png)

---

### Step 4. Installing Wazuh Agent on Windows 11

1. Log in to the Wazuh Dashboard.
2. Go to: Management → Agents → Add Agent.
3. Enter agent details (Name, IP, OS).
4. Copy the generated installation command.
5. Open PowerShell as Administrator.
6. Paste and execute the command.
7. Start the agent service:

   ```powershell
   net start wazuhsvc
   ```
![Wazuh-agent-creation](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-agent-creation-2.png)

![wazuh-agent-command](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh%20agent%20installing-1.png)

![wazuh-agent-installing](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-agent-installing-2.png)

---

### Step 5. Configure File Integrity Monitoring (FIM)

### Configuring File Integrity Monitoring

1. Open the Wazuh agent configuration file:

   C:\Program Files (x86)\ossec-agent\ossec.conf
   
![ossec-agent](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/ossec-agent.png)

3. Locate the <syscheck> section.
4. Add directories to monitor:

```md
  <directories check_all="yes" realtime="yes">C:\TestFIM</directories> 
  <directories check_all="yes">C:\Users</directories>
  <directories check_all="yes">C:\ImportantFiles</directories>
   ```
![ossec-conf](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/ossec-conf.png)

5. Save the file.
6. Restart the Wazuh agent service.

![wazuh-services](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-services-tab-2.png)

---

### Step 6. Restart and Verify Services

## Service Verification

1. Restart the Wazuh agent:

```powershell
net stop wazuhsvc
net start wazuhsvc
```
Check logs:

2. C:\Program Files (x86)\ossec-agent\ossec.log

3. Ensure no critical errors are present.

![ossec-log-confirmation](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/ossec-log-confirmation.jpeg)

4. Ensure that "Real-Time file integrity monitoring" message appeared.

---

### Step 7. Test Connectivity

1. Open Wazuh Dashboard.
2. Navigate to Agents.
3. Verify agent status is "Active".
4. Confirm last keepalive time is updating.

![wazuh-agent-active](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh%20agent%20active.png)
Agent status = Active

---

### Step 8. FIM Testing Scenarios
1. Directory Creation
2. File Creation
3. File Modification
4. File Deletion
5. Output Results in Wazuh Dashboard

## Expected Behavior

1. Wazuh agent detects new directory.
2. Syscheck (FIM module) generates an event.
3. Event is sent to Wazuh Manager.
4. Alert appears in Wazuh Dashboard.

### Step 9. Results

## File Integrity Monitoring Output

After performing file operations inside:

C:\TestFIM

The Wazuh Dashboard successfully detected and logged the following events:

- Directory creation detected
- File creation detected (Event: added | Rule ID: 554)
- File modification detected (Event: modified | Rule ID: 550)
- File deletion detected (Event: deleted | Rule ID: 553)

## Alert Details Observed

Each alert contained:

- Agent name
- File path (syscheck.path)
- Event type (added / modified / deleted)
- Rule ID and rule description
- Severity level
- Timestamp

## Dashboard Verification

- Alerts visible under: **File Integrity Monitoring → Events**
- Time filter used: **Last 15 minutes**
- Events indexed in OpenSearch
- Real-time detection confirmed

---

### Output Screenshots

![output-1](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/output-1.jpeg)
![main-output](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/main-output.jpeg)

---
### Security Analysis

## Detection Capability Assessment

The implemented File Integrity Monitoring (FIM) solution successfully detected and logged all unauthorized file activities performed within the monitored directory (`C:\TestFIM`). The Wazuh syscheck module generated real-time alerts for:

- File creation (Rule ID: 554)
- File modification / checksum change (Rule ID: 550)
- File deletion (Rule ID: 553)

This confirms that the monitoring configuration is functioning correctly and that endpoint-level visibility has been established.

---

## Threat Behavior Mapping

The observed file events directly align with common attacker techniques:

- **File Creation**  
  May indicate malware dropper activity, unauthorized script deployment, or persistence mechanisms.

- **File Modification**  
  Detected via checksum comparison, this can signal:
  - Configuration tampering
  - Backdoor insertion
  - Privilege escalation preparation
  - Data manipulation

- **File Deletion**  
  Often associated with:
  - Evidence removal
  - Log wiping
  - Anti-forensics techniques

The system successfully identified all these behaviors, demonstrating effective integrity monitoring.

---

## Alert Severity & Prioritization

The detected events included severity levels:

- Level 5 → File added
- Level 7 → File modified or deleted

Higher severity for modification and deletion reflects greater potential risk, supporting effective alert prioritization during SOC triage.

This allows analysts to:

- Quickly identify high-risk events
- Investigate potential compromise
- Reduce mean time to detection (MTTD)

---

## SOC Workflow Validation

The project validates a complete SIEM detection workflow:

1. Endpoint event generation (Windows Agent)
2. Secure log transmission to Wazuh Manager
3. Rule-based analysis and alert generation
4. Log indexing in OpenSearch
5. Visualization and investigation in Wazuh Dashboard

This demonstrates practical understanding of:

- Log pipelines
- Event correlation
- Detection engineering fundamentals
- Alert triage process

---

## Security Value

By implementing FIM:

- Unauthorized file changes are immediately visible.
- Integrity violations are traceable via hash comparison.
- Analysts gain forensic visibility into endpoint activity.
- Incident response time is significantly improved.

This implementation strengthens endpoint security monitoring and enhances proactive threat detection capabilities.


