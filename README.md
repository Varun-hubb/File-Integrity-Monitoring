# File-Integrity-Monitoring
This project demonstrates the implementation of File Integrity Monitoring using Wazuh SIEM to detect unauthorized file changes in real time.  The system monitors critical directories and generates alerts for file creation, modification, and deletion.

## Objective
The objective of this project is to implement and demonstrate File Integrity Monitoring (FIM) using Wazuh SIEM to detect, log, and analyze unauthorized changes to critical files and system configurations on a Windows system, enabling improved security monitoring and incident response.

## üèóÔ∏è System Architecture

![System Architecture](docs/architecture.drawio.png)

### üîπ Component Explanation

The architecture of this File Integrity Monitoring system consists of the following main components:

#### 1. Wazuh Agent (Windows Endpoint)
- Installed on the monitored Windows machine.
- Continuously monitors files, directories, and registry entries using the Syscheck module.
- Detects file creation, modification, deletion, and registry changes.
- Sends collected events securely to the Wazuh Manager.

#### 2. Wazuh Manager (Ubuntu Server)
- Acts as the central processing unit of the SIEM system.
- Receives security events from agents.
- Analyzes logs using predefined rules and decoders.
- Generates alerts based on file integrity violations.

#### 3. Filebeat
- Collects alerts and logs generated by the Wazuh Manager.
- Forwards them to OpenSearch for indexing and storage.
- Ensures reliable and real-time log transmission.

#### 4. OpenSearch (Indexer)
- Stores and indexes security events and alerts.
- Enables fast searching and filtering of file integrity data.
- Supports visualization and analytics.

#### 5. Wazuh Dashboard
- Provides a web-based interface for monitoring.
- Displays File Integrity Monitoring alerts and statistics.
- Allows filtering, searching, and analysis of security events.

#### 6. Administrator / Analyst
- Accesses the dashboard to monitor system integrity.
- Investigates suspicious file or registry changes.
- Takes corrective actions if needed.

### üîπ Data Flow Description

The data flow in the File Integrity Monitoring system follows a structured pipeline:

1. The Wazuh Agent continuously monitors configured files, folders, and registry paths on the Windows endpoint.

2. When a change occurs (create, modify, delete, or registry update), the Syscheck module detects the event in real time.

3. The detected event is packaged into a security log and sent securely to the Wazuh Manager.

4. The Wazuh Manager analyzes the incoming log using decoders and rules to determine its severity.

5. If the event matches a File Integrity Monitoring rule, an alert is generated.

6. Filebeat collects the generated alert from the Wazuh Manager.

7. Filebeat forwards the alert to OpenSearch over a secure connection.

8. OpenSearch indexes and stores the event for fast querying.

9. The Wazuh Dashboard retrieves indexed data from OpenSearch.

10. The Administrator views and analyzes the alerts through the dashboard interface.

## Technologies Used

- Wazuh SIEM (Manager, Agent, Dashboard)
- OpenSearch (Indexer)
- Filebeat (Log Forwarding)
- Ubuntu Linux (Wazuh Server)
- Windows 11 (Monitored Endpoint)
- VirtualBox (Virtualization Platform)
- Draw.io (Architecture Diagram Tool)
- Git & GitHub (Version Control)

## üõ†Ô∏è Installation and Setup

This section describes the complete setup process from installing Wazuh v4.12 to validating File Integrity Monitoring (FIM).

---

### Step 1: Install Wazuh Server (Ubuntu 22.04)
1. Log in to the Ubuntu virtual machine.
2. Update the system packages:

   ```bash
   sudo apt update && sudo apt upgrade -y
   ```
3. Download and execute the official installation script:

```bash
curl -sO https://packages.wazuh.com/4.14/wazuh-install.sh
sudo bash wazuh-install.sh -a
```
![Wazuh Install](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/Wazuh%20Installed.png)

4. Wait for the installation to complete.
5. Note down the generated admin credentials.

---

### Step 2: Verify Installation

```md
### Step 2: Verify Installation

```bash
sudo systemctl status wazuh-manager
sudo systemctl status wazuh-indexer
sudo systemctl status wazuh-dashboard
````

![Services](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-manager-status.png)

---

### Step 3. Access Wazuh Dashboard

## Accessing the Wazuh Dashboard

1. Open a web browser on the Ubuntu system.
2. Navigate to:

```md
   https://localhost
```
3. Accept the security warning.
4. Log in using the admin credentials.
5. Verify that the dashboard loads successfully.

![Wazuh-login-page](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-login-page.png)

![Dashboard](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-dashboard-1.png)

---

### Step 4. Installing Wazuh Agent on Windows 11

1. Log in to the Wazuh Dashboard.
2. Go to: Management ‚Üí Agents ‚Üí Add Agent.
3. Enter agent details (Name, IP, OS).
4. Copy the generated installation command.
5. Open PowerShell as Administrator.
6. Paste and execute the command.
7. Start the agent service:

   ```powershell
   net start wazuhsvc
   ```
![Wazuh-agent-creation](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-agent-creation-2.png)

![wazuh-agent-command](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh%20agent%20installing-1.png)

![wazuh-agent-installing](https://github.com/Varun-hubb/File-Integrity-Monitoring/blob/main/screenshots/wazuh-agent-installing-2.png)

---

### Step 5. Configure File Integrity Monitoring (FIM)

### Configuring File Integrity Monitoring

1. Open the Wazuh agent configuration file:

   C:\Program Files (x86)\ossec-agent\ossec.conf

2. Locate the <syscheck> section.
3. Add directories to monitor:

   ```xml
   <directories check_all="yes">C:\TestFolder</directories>
   ```
4. Save the file.
5. Restart the Wazuh agent service.



